/*
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ğŸ¨ CHENU - CREATIVE STUDIO                                                 â•‘
â•‘   Content Editor, Templates, AI Generation, Preview                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*/

import React, { useState } from 'react';

export const CONTENT_TEMPLATES = [
  { id: 'blog', name: 'ğŸ“ Blog Post', icon: 'ğŸ“', sections: ['Title', 'Introduction', 'Body', 'Conclusion', 'CTA'], tokens: 2000 },
  { id: 'social', name: 'ğŸ“± Social Media', icon: 'ğŸ“±', sections: ['Hook', 'Content', 'Hashtags', 'CTA'], tokens: 500 },
  { id: 'email', name: 'ğŸ“§ Email Campaign', icon: 'ğŸ“§', sections: ['Subject', 'Preview', 'Header', 'Body', 'CTA', 'Footer'], tokens: 1000 },
  { id: 'ad', name: 'ğŸ¯ Ad Copy', icon: 'ğŸ¯', sections: ['Headline', 'Description', 'CTA', 'Keywords'], tokens: 300 },
  { id: 'video', name: 'ğŸ¬ Video Script', icon: 'ğŸ¬', sections: ['Hook', 'Problem', 'Solution', 'Benefits', 'CTA'], tokens: 1500 },
  { id: 'landing', name: 'ğŸš€ Landing Page', icon: 'ğŸš€', sections: ['Hero', 'Problem', 'Solution', 'Features', 'Testimonials', 'CTA'], tokens: 2500 },
  { id: 'product', name: 'ğŸ›ï¸ Product Description', icon: 'ğŸ›ï¸', sections: ['Title', 'Features', 'Benefits', 'Specs', 'CTA'], tokens: 800 },
  { id: 'press', name: 'ğŸ“° Press Release', icon: 'ğŸ“°', sections: ['Headline', 'Subhead', 'Lead', 'Body', 'Boilerplate', 'Contact'], tokens: 1200 }
];

export const BRAND_VOICES = [
  { id: 'professional', name: 'Professional', emoji: 'ğŸ‘”', description: 'Formal, authoritative, trustworthy' },
  { id: 'friendly', name: 'Friendly', emoji: 'ğŸ˜Š', description: 'Warm, approachable, conversational' },
  { id: 'bold', name: 'Bold', emoji: 'ğŸ”¥', description: 'Confident, energetic, impactful' },
  { id: 'playful', name: 'Playful', emoji: 'ğŸ‰', description: 'Fun, witty, entertaining' },
  { id: 'luxury', name: 'Luxury', emoji: 'âœ¨', description: 'Elegant, sophisticated, exclusive' },
  { id: 'technical', name: 'Technical', emoji: 'âš™ï¸', description: 'Precise, detailed, expert' }
];

const CreativeStudio = ({ isOpen, onClose, onGenerate, onSave, savedContent = [] }) => {
  const [activeTab, setActiveTab] = useState('create');
  const [selectedTemplate, setSelectedTemplate] = useState(null);
  const [brandVoice, setBrandVoice] = useState('professional');
  const [content, setContent] = useState({});
  const [generating, setGenerating] = useState(false);
  const [previewMode, setPreviewMode] = useState(false);
  
  const [projectSettings, setProjectSettings] = useState({
    name: '', targetAudience: '', keywords: '', tone: '', language: 'en', platform: ''
  });

  const handleSelectTemplate = (template) => {
    setSelectedTemplate(template);
    const initialContent = {};
    template.sections.forEach(s => { initialContent[s] = ''; });
    setContent(initialContent);
  };

  const handleGenerate = async (section) => {
    setGenerating(true);
    // Simulate AI generation
    setTimeout(() => {
      const generated = `[AI Generated ${section} content for ${selectedTemplate?.name} in ${brandVoice} voice targeting ${projectSettings.targetAudience || 'general audience'}...]`;
      setContent(prev => ({ ...prev, [section]: generated }));
      setGenerating(false);
    }, 1500);
    onGenerate?.({ section, template: selectedTemplate, voice: brandVoice, settings: projectSettings });
  };

  const handleGenerateAll = async () => {
    setGenerating(true);
    for (const section of selectedTemplate?.sections || []) {
      await new Promise(r => setTimeout(r, 800));
      setContent(prev => ({ ...prev, [section]: `[AI Generated ${section}...]` }));
    }
    setGenerating(false);
  };

  const handleSave = () => {
    onSave?.({ template: selectedTemplate, content, settings: projectSettings, voice: brandVoice, savedAt: new Date().toISOString() });
  };

  if (!isOpen) return null;

  return (
    <div className="cs-overlay">
      <div className="cs-modal">
        <header className="cs-header">
          <div className="cs-header-left"><span>ğŸ¨</span><div><h1>Creative Studio</h1><p>AI-powered content creation</p></div></div>
          <div className="cs-header-actions">
            {selectedTemplate && <button className="cs-btn" onClick={() => setPreviewMode(!previewMode)}>{previewMode ? 'âœï¸ Edit' : 'ğŸ‘ï¸ Preview'}</button>}
            <button className="cs-close" onClick={onClose}>âœ•</button>
          </div>
        </header>

        <nav className="cs-tabs">
          <button className={activeTab === 'create' ? 'active' : ''} onClick={() => setActiveTab('create')}>âœ¨ Create</button>
          <button className={activeTab === 'templates' ? 'active' : ''} onClick={() => setActiveTab('templates')}>ğŸ“‹ Templates</button>
          <button className={activeTab === 'library' ? 'active' : ''} onClick={() => setActiveTab('library')}>ğŸ“š Library</button>
          <button className={activeTab === 'settings' ? 'active' : ''} onClick={() => setActiveTab('settings')}>âš™ï¸ Settings</button>
        </nav>

        <div className="cs-body">
          {/* TEMPLATES TAB */}
          {activeTab === 'templates' && (
            <div className="cs-templates">
              <h2>Choose a Template</h2>
              <div className="cs-template-grid">
                {CONTENT_TEMPLATES.map(t => (
                  <div key={t.id} className={`cs-template-card ${selectedTemplate?.id === t.id ? 'selected' : ''}`} onClick={() => { handleSelectTemplate(t); setActiveTab('create'); }}>
                    <span className="cs-template-icon">{t.icon}</span>
                    <h3>{t.name}</h3>
                    <div className="cs-template-sections">{t.sections.map((s, i) => <span key={i}>{s}</span>)}</div>
                    <div className="cs-template-meta"><span>ğŸª™ ~{t.tokens} tokens</span><span>ğŸ“„ {t.sections.length} sections</span></div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* CREATE TAB */}
          {activeTab === 'create' && (
            <div className="cs-create">
              {!selectedTemplate ? (
                <div className="cs-no-template">
                  <span>ğŸ“‹</span>
                  <h2>Select a Template</h2>
                  <p>Choose a content template to get started</p>
                  <button onClick={() => setActiveTab('templates')}>Browse Templates</button>
                </div>
              ) : (
                <div className="cs-editor-layout">
                  <aside className="cs-editor-sidebar">
                    <div className="cs-sidebar-section">
                      <h3>ğŸ“‹ Template</h3>
                      <div className="cs-current-template">
                        <span>{selectedTemplate.icon}</span>
                        <div><strong>{selectedTemplate.name}</strong><small>{selectedTemplate.sections.length} sections</small></div>
                        <button onClick={() => setActiveTab('templates')}>Change</button>
                      </div>
                    </div>

                    <div className="cs-sidebar-section">
                      <h3>ğŸ­ Brand Voice</h3>
                      <div className="cs-voice-options">
                        {BRAND_VOICES.map(v => (
                          <button key={v.id} className={`cs-voice-btn ${brandVoice === v.id ? 'selected' : ''}`} onClick={() => setBrandVoice(v.id)}>
                            <span>{v.emoji}</span><div><strong>{v.name}</strong><small>{v.description}</small></div>
                          </button>
                        ))}
                      </div>
                    </div>

                    <div className="cs-sidebar-section">
                      <h3>ğŸ¯ Project Details</h3>
                      <div className="cs-field"><label>Project Name</label><input value={projectSettings.name} onChange={(e) => setProjectSettings(p => ({...p, name: e.target.value}))} placeholder="My Campaign" /></div>
                      <div className="cs-field"><label>Target Audience</label><input value={projectSettings.targetAudience} onChange={(e) => setProjectSettings(p => ({...p, targetAudience: e.target.value}))} placeholder="e.g., Young professionals" /></div>
                      <div className="cs-field"><label>Keywords</label><input value={projectSettings.keywords} onChange={(e) => setProjectSettings(p => ({...p, keywords: e.target.value}))} placeholder="keyword1, keyword2" /></div>
                    </div>

                    <button className="cs-generate-all" onClick={handleGenerateAll} disabled={generating}>
                      {generating ? 'â³ Generating...' : 'âœ¨ Generate All Sections'}
                    </button>
                    <button className="cs-save-btn" onClick={handleSave}>ğŸ’¾ Save to Library</button>
                  </aside>

                  <main className="cs-editor-main">
                    {previewMode ? (
                      <div className="cs-preview">
                        <h2>Preview: {selectedTemplate.name}</h2>
                        <div className="cs-preview-content">
                          {selectedTemplate.sections.map(section => (
                            <div key={section} className="cs-preview-section">
                              <h3>{section}</h3>
                              <p>{content[section] || <em>No content yet</em>}</p>
                            </div>
                          ))}
                        </div>
                      </div>
                    ) : (
                      <div className="cs-sections">
                        {selectedTemplate.sections.map((section, idx) => (
                          <div key={section} className="cs-section-editor">
                            <div className="cs-section-header">
                              <span className="cs-section-num">{idx + 1}</span>
                              <h3>{section}</h3>
                              <button className="cs-generate-btn" onClick={() => handleGenerate(section)} disabled={generating}>
                                {generating ? 'â³' : 'âœ¨'} Generate
                              </button>
                            </div>
                            <textarea value={content[section] || ''} onChange={(e) => setContent(prev => ({ ...prev, [section]: e.target.value }))} placeholder={`Write your ${section.toLowerCase()} here...`} rows={4} />
                            <div className="cs-section-tools">
                              <button>ğŸ”„ Rewrite</button>
                              <button>ğŸ“ Expand</button>
                              <button>âœ‚ï¸ Shorten</button>
                              <button>ğŸ¯ Improve</button>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </main>
                </div>
              )}
            </div>
          )}

          {/* LIBRARY TAB */}
          {activeTab === 'library' && (
            <div className="cs-library">
              <h2>ğŸ“š Content Library</h2>
              {savedContent.length === 0 ? (
                <div className="cs-empty"><span>ğŸ“­</span><p>No saved content yet</p></div>
              ) : (
                <div className="cs-library-grid">
                  {savedContent.map((item, i) => (
                    <div key={i} className="cs-library-item">
                      <span>{item.template?.icon}</span>
                      <div><strong>{item.settings?.name || 'Untitled'}</strong><small>{item.template?.name}</small></div>
                      <span className="cs-library-date">{new Date(item.savedAt).toLocaleDateString()}</span>
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          {/* SETTINGS TAB */}
          {activeTab === 'settings' && (
            <div className="cs-settings">
              <h2>âš™ï¸ Studio Settings</h2>
              <div className="cs-settings-grid">
                <div className="cs-setting-card">
                  <h3>ğŸŒ Default Language</h3>
                  <select value={projectSettings.language} onChange={(e) => setProjectSettings(p => ({...p, language: e.target.value}))}>
                    <option value="en">English</option><option value="fr">FranÃ§ais</option><option value="es">EspaÃ±ol</option><option value="de">Deutsch</option>
                  </select>
                </div>
                <div className="cs-setting-card">
                  <h3>ğŸ¤– AI Model</h3>
                  <select><option>GPT-4o</option><option>GPT-4o-mini</option><option>Claude 3</option></select>
                </div>
                <div className="cs-setting-card">
                  <h3>ğŸ¨ Default Voice</h3>
                  <select value={brandVoice} onChange={(e) => setBrandVoice(e.target.value)}>
                    {BRAND_VOICES.map(v => <option key={v.id} value={v.id}>{v.emoji} {v.name}</option>)}
                  </select>
                </div>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default CreativeStudio;
