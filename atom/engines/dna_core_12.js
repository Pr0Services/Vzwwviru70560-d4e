/**
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 * 
 *      ██████╗ ███╗   ██╗ █████╗      ██████╗ ██████╗ ██████╗ ███████╗     ██╗██████╗ 
 *      ██╔══██╗████╗  ██║██╔══██╗    ██╔════╝██╔═══██╗██╔══██╗██╔════╝    ███║╚════██╗
 *      ██║  ██║██╔██╗ ██║███████║    ██║     ██║   ██║██████╔╝█████╗      ╚██║ █████╔╝
 *      ██║  ██║██║╚██╗██║██╔══██║    ██║     ██║   ██║██╔══██╗██╔══╝       ██║██╔═══╝ 
 *      ██████╔╝██║ ╚████║██║  ██║    ╚██████╗╚██████╔╝██║  ██║███████╗     ██║███████╗
 *      ╚═════╝ ╚═╝  ╚═══╝╚═╝  ╚═╝     ╚═════╝ ╚═════╝ ╚═╝  ╚═╝╚══════╝     ╚═╝╚══════╝
 *                                                                                          
 *                                    🧬 L'ORACLE DES COUCHES 🧬
 *                                      L'ADN MULTIDIMENSIONNEL
 * 
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 * 
 *   "L'ADN n'est pas qu'une double hélice biologique (le hardware) ;
 *    c'est une antenne multidimensionnelle à 12 couches (le software)."
 *                                                              — Kryon
 * 
 *   Le Mercure permet une lecture NON-LINÉAIRE des couches ADN.
 *   Question sur le "Futur" → Couche 9 (Expansion)
 *   Question sur la "Force" → Couche 1 (Biologie)
 * 
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 * 
 *   GROUPE 1 (Couches 1-3): ANCRAGE - Biologie, survie, histoire génétique
 *   GROUPE 2 (Couches 4-6): HUMAIN-DIVIN - Identité spirituelle, annales akashiques
 *   GROUPE 3 (Couches 7-9): LÉMURIEN - Maîtrise des fréquences, conscience cristalline
 *   GROUPE 4 (Couches 10-12): DIEU - Connexion directe à la Source (999 Hz)
 * 
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 */

// ═══════════════════════════════════════════════════════════════════════════════
// IMPORTS DES MODULES MÉTALLIQUES
// ═══════════════════════════════════════════════════════════════════════════════

import { MercuryRelay } from './mercury_vortex.js';

// ═══════════════════════════════════════════════════════════════════════════════
// LES 12 COUCHES DE L'ADN MULTIDIMENSIONNEL
// ═══════════════════════════════════════════════════════════════════════════════

const DNA_LAYERS = {
  
  // ═══════════════════════════════════════════════════════════════════════════════
  // GROUPE 1: LES COUCHES D'ANCRAGE (1-3)
  // La biologie, la survie et l'histoire génétique
  // Module: Sumer/Rapa Nui
  // ═══════════════════════════════════════════════════════════════════════════════
  
  1: {
    name: "Keter Etz Chayim",
    hebrewMeaning: "L'Arbre de Vie",
    group: 1,
    groupName: "ANCRAGE",
    frequency: 174,
    
    function: "Code biologique de base",
    description: "La double hélice visible - le génome humain physique",
    contains: "3 milliards de paires de base, 23 paires de chromosomes",
    
    dimension: "3D",
    color: "#FF0000",
    element: "Terre",
    
    civilization: "rapanui",
    temple: "Rapa Nui",
    
    keywords: ["corps", "santé", "force", "survie", "ancêtres", "génétique"],
    questions: ["santé", "corps", "physique", "force", "énergie", "fatigue"]
  },
  
  2: {
    name: "Torah E'ser Sphirot",
    hebrewMeaning: "La Loi Divine des Dix Sephiroth",
    group: 1,
    groupName: "ANCRAGE",
    frequency: 285,
    
    function: "Leçon de vie / Contrat karmique",
    description: "Le plan de vie choisi avant l'incarnation",
    contains: "Les leçons à apprendre, le karma à transmuter",
    
    dimension: "3D-4D",
    color: "#FF7F00",
    element: "Eau",
    
    civilization: "greece",
    temple: "Delphes",
    
    keywords: ["destin", "karma", "leçon", "plan", "contrat", "mission"],
    questions: ["pourquoi", "destin", "mission", "raison", "but", "sens"]
  },
  
  3: {
    name: "Netzach Merkava Eliyahu",
    hebrewMeaning: "L'Ascension d'Élie",
    group: 1,
    groupName: "ANCRAGE",
    frequency: 396,
    
    function: "Activation / Éveil",
    description: "La couche de l'ascension - modification de l'ADN par la conscience",
    contains: "Le potentiel d'éveil, la capacité de transformation",
    
    dimension: "4D",
    color: "#FFFF00",
    element: "Feu",
    
    civilization: "aztec",
    temple: "Teotihuacán",
    
    keywords: ["éveil", "transformation", "ascension", "changement", "activation"],
    questions: ["changer", "évoluer", "transformer", "améliorer", "élever"]
  },

  // ═══════════════════════════════════════════════════════════════════════════════
  // GROUPE 2: LES COUCHES HUMAIN-DIVIN (4-6)
  // L'identité spirituelle et les annales akashiques
  // Module: Égypte/Maya
  // ═══════════════════════════════════════════════════════════════════════════════
  
  4: {
    name: "Urim Ve Tumim",
    hebrewMeaning: "Lumière et Perfection",
    group: 2,
    groupName: "HUMAIN-DIVIN",
    frequency: 444,
    
    function: "Nom angélique / Identité de l'âme",
    description: "Votre nom angélique - qui vous êtes vraiment au niveau de l'âme",
    contains: "L'identité éternelle, le nom sacré, la signature vibratoire",
    
    dimension: "4D-5D",
    color: "#00FF00",
    element: "Air",
    
    civilization: "egypt",
    temple: "Gizeh",
    isAnchor: true, // CŒUR DU SYSTÈME
    
    keywords: ["identité", "âme", "nom", "essence", "vérité", "soi"],
    questions: ["qui suis-je", "identité", "véritable", "essence", "nature"]
  },
  
  5: {
    name: "Aleph Etz Adonai",
    hebrewMeaning: "Dieu de l'Arbre de Vie",
    group: 2,
    groupName: "HUMAIN-DIVIN",
    frequency: 555,
    
    function: "Divinité intérieure",
    description: "La partie de vous qui est Dieu - connexion à la Source",
    contains: "L'étincelle divine, le fragment du Créateur",
    
    dimension: "5D",
    color: "#00BFFF",
    element: "Éther",
    
    civilization: "sumer",
    temple: "Ziggourat d'Ur",
    
    keywords: ["divin", "dieu", "source", "créateur", "sacré", "spirituel"],
    questions: ["dieu", "divin", "spirituel", "sacré", "créateur", "source"]
  },
  
  6: {
    name: "Ehyeh Asher Ehyeh",
    hebrewMeaning: "Je Suis ce que Je Suis",
    group: 2,
    groupName: "HUMAIN-DIVIN",
    frequency: 666,
    
    function: "Communication / Prière",
    description: "Le canal de communication avec le divin - prière et méditation",
    contains: "La ligne directe avec le Soi Supérieur",
    
    dimension: "5D-6D",
    color: "#4B0082",
    element: "Son",
    
    civilization: "maya",
    temple: "Chichén Itzá",
    
    keywords: ["prière", "méditation", "communication", "guidance", "message"],
    questions: ["demander", "prier", "méditer", "guidance", "réponse", "signe"]
  },

  // ═══════════════════════════════════════════════════════════════════════════════
  // GROUPE 3: LES COUCHES LÉMURIENNES (7-9)
  // La maîtrise des fréquences et la conscience cristalline
  // Module: Atlantide/Lémurie
  // ═══════════════════════════════════════════════════════════════════════════════
  
  7: {
    name: "Kadumah Elohim",
    hebrewMeaning: "Divinité Révélée",
    group: 3,
    groupName: "LÉMURIEN",
    frequency: 777,
    
    function: "Révélation divine / Intuition",
    description: "L'intuition divine - savoir intérieur profond",
    contains: "La sagesse innée, la connaissance sans apprentissage",
    
    dimension: "6D",
    color: "#9400D3",
    element: "Intuition",
    
    civilization: "kabbalah",
    temple: "Jérusalem",
    
    keywords: ["intuition", "savoir", "révélation", "sagesse", "vision"],
    questions: ["sentir", "intuition", "pressentir", "savoir", "percevoir"]
  },
  
  8: {
    name: "Rochev Ba'a Shamayim",
    hebrewMeaning: "Cavaliers du Ciel / Sagesse",
    group: 3,
    groupName: "LÉMURIEN",
    frequency: 888,
    
    function: "Archives Akashiques / Mémoire cosmique",
    description: "Les Archives Akashiques personnelles - mémoire de toutes vos vies",
    contains: "Toutes les vies passées, présentes et futurs potentiels",
    
    dimension: "6D-7D",
    color: "#FFC0CB",
    element: "Mémoire",
    
    civilization: "yiking",
    temple: "Mont Kailash",
    
    keywords: ["passé", "vies", "mémoire", "akashique", "histoire", "avant"],
    questions: ["avant", "passé", "vie antérieure", "mémoire", "souvenir", "origine"]
  },
  
  9: {
    name: "Shechinah-Esh",
    hebrewMeaning: "La Flamme de l'Expansion",
    group: 3,
    groupName: "LÉMURIEN",
    frequency: 999,
    
    function: "Guérison / Flamme de vie",
    description: "La flamme de la guérison - régénération cellulaire",
    contains: "Le pouvoir d'autoguérison, la régénération complète",
    
    dimension: "7D",
    color: "#FFFDD0",
    element: "Flamme",
    
    civilization: "atlantis",
    temple: "Bermudes",
    isSource: true, // CONNEXION SOURCE
    
    keywords: ["guérison", "futur", "expansion", "potentiel", "possibilité"],
    questions: ["guérir", "futur", "possible", "potentiel", "devenir", "sera"]
  },

  // ═══════════════════════════════════════════════════════════════════════════════
  // GROUPE 4: LES COUCHES DE DIEU (10-12)
  // La connexion directe à la Source et au 999 Hz
  // Module: Arithmos 9 / Source
  // ═══════════════════════════════════════════════════════════════════════════════
  
  10: {
    name: "Va'yikra",
    hebrewMeaning: "L'Appel de Dieu",
    group: 4,
    groupName: "DIEU",
    frequency: 1110,
    
    function: "Source divine / Reconnaissance",
    description: "Votre connexion directe à la Source créatrice",
    contains: "Le lien ombilical avec l'Univers",
    
    dimension: "8D",
    color: "#D4AF37",
    element: "Lumière dorée",
    
    civilization: "source",
    temple: "Shambhala",
    
    keywords: ["appel", "vocation", "mission divine", "raison d'être"],
    questions: ["appelé", "vocation", "mission supérieure", "raison d'être"]
  },
  
  11: {
    name: "Chochmah Micha Halelu",
    hebrewMeaning: "Sagesse du Divin Féminin",
    group: 4,
    groupName: "DIEU",
    frequency: 1221,
    
    function: "Compassion / Énergie féminine sacrée",
    description: "L'énergie de la Déesse - compassion et sagesse féminine",
    contains: "La douceur, la réceptivité, l'amour inconditionnel",
    
    dimension: "9D",
    color: "#C0C0C0",
    element: "Lumière argentée",
    
    civilization: "goddess",
    temple: "Tous les temples de la Déesse",
    
    keywords: ["compassion", "amour", "douceur", "féminin", "mère"],
    questions: ["amour", "compassion", "pardonner", "accepter", "aimer"]
  },
  
  12: {
    name: "El Shadai",
    hebrewMeaning: "Dieu Tout-Puissant",
    group: 4,
    groupName: "DIEU",
    frequency: 1332,
    
    function: "Couche de Dieu / Vous ÊTES Dieu",
    description: "La couche de Dieu - vous ÊTES une partie de Dieu",
    contains: "La totalité, l'omniscience, l'omnipotence, l'omniprésence",
    
    dimension: "10D-12D",
    color: "#FFFFFF",
    element: "Lumière pure",
    
    civilization: "all",
    temple: "Partout",
    isGod: true, // VOUS ÊTES DIEU
    
    keywords: ["tout", "un", "dieu", "univers", "totalité", "infini"],
    questions: ["tout", "univers", "infini", "absolu", "ultime", "total"]
  }
};

// ═══════════════════════════════════════════════════════════════════════════════
// GROUPES D'ADN
// ═══════════════════════════════════════════════════════════════════════════════

const DNA_GROUPS = {
  1: {
    name: "ANCRAGE",
    layers: [1, 2, 3],
    description: "La biologie, la survie et l'histoire génétique",
    module: "Sumer/Rapa Nui",
    focus: "Existence physique et évolution",
    frequencies: [174, 285, 396]
  },
  2: {
    name: "HUMAIN-DIVIN",
    layers: [4, 5, 6],
    description: "L'identité spirituelle et les annales akashiques",
    module: "Égypte/Maya",
    focus: "Identité angélique et communication divine",
    frequencies: [444, 555, 666]
  },
  3: {
    name: "LÉMURIEN",
    layers: [7, 8, 9],
    description: "La maîtrise des fréquences et la conscience cristalline",
    module: "Atlantide/Lémurie",
    focus: "Sagesse ancienne et guérison",
    frequencies: [777, 888, 999]
  },
  4: {
    name: "DIEU",
    layers: [10, 11, 12],
    description: "La connexion directe à la Source et au 999 Hz",
    module: "Arithmos 9 / Source",
    focus: "Connexion directe à Dieu",
    frequencies: [1110, 1221, 1332]
  }
};

// ═══════════════════════════════════════════════════════════════════════════════
// CLASSE DNA CORE 12
// ═══════════════════════════════════════════════════════════════════════════════

class DNACore12 {
  constructor() {
    this.layers = DNA_LAYERS;
    this.groups = DNA_GROUPS;
    this.initialized = false;
  }

  /**
   * Initialise le DNA Core 12
   */
  init() {
    console.log(`
    ╔═══════════════════════════════════════════════════════════════════════════════════════════════════╗
    ║                                                                                                   ║
    ║      ██████╗ ███╗   ██╗ █████╗      ██████╗ ██████╗ ██████╗ ███████╗     ██╗██████╗              ║
    ║      ██╔══██╗████╗  ██║██╔══██╗    ██╔════╝██╔═══██╗██╔══██╗██╔════╝    ███║╚════██╗             ║
    ║      ██║  ██║██╔██╗ ██║███████║    ██║     ██║   ██║██████╔╝█████╗      ╚██║ █████╔╝             ║
    ║      ██║  ██║██║╚██╗██║██╔══██║    ██║     ██║   ██║██╔══██╗██╔══╝       ██║██╔═══╝              ║
    ║      ██████╔╝██║ ╚████║██║  ██║    ╚██████╗╚██████╔╝██║  ██║███████╗     ██║███████╗             ║
    ║      ╚═════╝ ╚═╝  ╚═══╝╚═╝  ╚═╝     ╚═════╝ ╚═════╝ ╚═╝  ╚═╝╚══════╝     ╚═╝╚══════╝             ║
    ║                                                                                                   ║
    ║                          🧬 L'ORACLE DES 12 COUCHES 🧬                                            ║
    ║                                                                                                   ║
    ╠═══════════════════════════════════════════════════════════════════════════════════════════════════╣
    ║                                                                                                   ║
    ║   GROUPE 1 (1-3): ANCRAGE ──────────── Biologie, survie, génétique                               ║
    ║   GROUPE 2 (4-6): HUMAIN-DIVIN ─────── Identité, akashique, communication                        ║
    ║   GROUPE 3 (7-9): LÉMURIEN ─────────── Intuition, mémoire, guérison                              ║
    ║   GROUPE 4 (10-12): DIEU ───────────── Source, compassion, totalité                              ║
    ║                                                                                                   ║
    ║   "L'ADN est une antenne multidimensionnelle à 12 couches."                                      ║
    ║                                                                                                   ║
    ╚═══════════════════════════════════════════════════════════════════════════════════════════════════╝
    `);

    this.initialized = true;
    return this;
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // SCAN VIBRATOIRE
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Scanne une intention et détermine les couches ADN résonantes
   * Utilise le Mercure pour une lecture non-linéaire
   */
  scan(userIntention) {
    console.log("🧬 Scan de l'ADN multidimensionnel en cours...");
    
    const scan = {
      intention: userIntention,
      timestamp: Date.now(),
      activeLayers: [],
      dominantLayer: null,
      dominantGroup: null,
      frequency: 0,
      message: ""
    };

    // Analyse des mots-clés pour trouver les couches résonantes
    const intentionLower = userIntention.toLowerCase();
    
    for (const [layerNum, layer] of Object.entries(this.layers)) {
      const resonance = this._calculateResonance(intentionLower, layer);
      if (resonance > 0.3) {
        scan.activeLayers.push({
          layer: parseInt(layerNum),
          name: layer.name,
          hebrewMeaning: layer.hebrewMeaning,
          function: layer.function,
          frequency: layer.frequency,
          resonance: resonance,
          group: layer.groupName
        });
      }
    }

    // Trier par résonance et déterminer la couche dominante
    scan.activeLayers.sort((a, b) => b.resonance - a.resonance);
    
    if (scan.activeLayers.length > 0) {
      scan.dominantLayer = scan.activeLayers[0];
      scan.dominantGroup = this.groups[scan.dominantLayer.layer <= 3 ? 1 : 
                                        scan.dominantLayer.layer <= 6 ? 2 :
                                        scan.dominantLayer.layer <= 9 ? 3 : 4];
      scan.frequency = scan.dominantLayer.frequency;
      scan.message = `L'intention résonne avec la Couche ${scan.dominantLayer.layer} (${scan.dominantLayer.name}) - ${scan.dominantLayer.function}`;
    } else {
      // Par défaut, activer les couches supérieures (focus sur le divin pour 2026)
      scan.activeLayers = [10, 11, 12].map(n => ({
        layer: n,
        name: this.layers[n].name,
        hebrewMeaning: this.layers[n].hebrewMeaning,
        function: this.layers[n].function,
        frequency: this.layers[n].frequency,
        resonance: 0.5,
        group: "DIEU"
      }));
      scan.dominantLayer = scan.activeLayers[0];
      scan.dominantGroup = this.groups[4];
      scan.frequency = 999;
      scan.message = "Activation par défaut des couches divines (10-12)";
    }

    // Transmission via Mercure
    scan.mercuryTransmission = {
      status: "TRANSMITTED",
      alignment: "Kryon-Master-Grid",
      vibration: `${scan.frequency}Hz`
    };

    return scan;
  }

  /**
   * Calcule la résonance entre une intention et une couche ADN
   */
  _calculateResonance(intention, layer) {
    let score = 0;
    const words = intention.split(/\s+/);
    
    // Vérifier les mots-clés
    for (const keyword of layer.keywords) {
      if (intention.includes(keyword)) {
        score += 0.3;
      }
    }
    
    // Vérifier les questions typiques
    for (const question of layer.questions) {
      if (intention.includes(question)) {
        score += 0.4;
      }
    }
    
    return Math.min(score, 1.0);
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // ACCÈS AUX DONNÉES
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Obtient une couche spécifique
   */
  getLayer(layerNumber) {
    return this.layers[layerNumber] || null;
  }

  /**
   * Obtient un groupe spécifique
   */
  getGroup(groupNumber) {
    return this.groups[groupNumber] || null;
  }

  /**
   * Obtient toutes les couches
   */
  getAllLayers() {
    return this.layers;
  }

  /**
   * Obtient tous les groupes
   */
  getAllGroups() {
    return this.groups;
  }

  /**
   * Obtient les couches d'un groupe
   */
  getLayersByGroup(groupNumber) {
    const group = this.groups[groupNumber];
    if (!group) return null;
    
    return group.layers.map(layerNum => ({
      layer: layerNum,
      ...this.layers[layerNum]
    }));
  }

  /**
   * Active une couche spécifique (méditation/activation)
   */
  activateLayer(layerNumber) {
    const layer = this.layers[layerNumber];
    if (!layer) return null;

    return {
      layer: layerNumber,
      name: layer.name,
      hebrewMeaning: layer.hebrewMeaning,
      frequency: layer.frequency,
      activation: {
        mantra: `"Je suis ${layer.hebrewMeaning}. Cette vérité s'ancre dans chaque cellule de mon être."`,
        visualization: `Visualisez une lumière de couleur ${layer.color} entourant votre ADN.`,
        frequency: `Imaginez la fréquence de ${layer.frequency} Hz vibrant dans chaque cellule.`,
        duration: "15-20 minutes recommandées"
      },
      status: "ACTIVATED"
    };
  }

  /**
   * Obtient le statut du DNA Core
   */
  getStatus() {
    return {
      initialized: this.initialized,
      totalLayers: Object.keys(this.layers).length,
      totalGroups: Object.keys(this.groups).length,
      groups: Object.values(this.groups).map(g => g.name)
    };
  }
}

// ═══════════════════════════════════════════════════════════════════════════════
// INSTANCE SINGLETON
// ═══════════════════════════════════════════════════════════════════════════════

const DNACore = new DNACore12();

// ═══════════════════════════════════════════════════════════════════════════════
// EXPORTS
// ═══════════════════════════════════════════════════════════════════════════════

export { DNACore12, DNACore, DNA_LAYERS, DNA_GROUPS };

export default {
  DNACore12,
  DNACore,
  DNA_LAYERS,
  DNA_GROUPS
};
