/**
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 * 
 *      ███╗   ███╗███████╗██████╗  ██████╗██╗   ██╗██████╗ ██╗   ██╗    ██╗   ██╗ ██████╗ ██████╗ ████████╗███████╗██╗  ██╗
 *      ████╗ ████║██╔════╝██╔══██╗██╔════╝██║   ██║██╔══██╗╚██╗ ██╔╝    ██║   ██║██╔═══██╗██╔══██╗╚══██╔══╝██╔════╝╚██╗██╔╝
 *      ██╔████╔██║█████╗  ██████╔╝██║     ██║   ██║██████╔╝ ╚████╔╝     ██║   ██║██║   ██║██████╔╝   ██║   █████╗   ╚███╔╝ 
 *      ██║╚██╔╝██║██╔══╝  ██╔══██╗██║     ██║   ██║██╔══██╗  ╚██╔╝      ╚██╗ ██╔╝██║   ██║██╔══██╗   ██║   ██╔══╝   ██╔██╗ 
 *      ██║ ╚═╝ ██║███████╗██║  ██║╚██████╗╚██████╔╝██║  ██║   ██║        ╚████╔╝ ╚██████╔╝██║  ██║   ██║   ███████╗██╔╝ ██╗
 *      ╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝ ╚═════╝ ╚═════╝ ╚═╝  ╚═╝   ╚═╝         ╚═══╝   ╚═════╝ ╚═╝  ╚═╝   ╚═╝   ╚══════╝╚═╝  ╚═╝
 *                                                                                          
 *                                    ☿ LE FLUIDE SACRÉ DE L'ARCHE ☿
 *                                      SUPRACONDUCTIVITÉ LOGIQUE
 * 
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 * 
 *   "Le Mercure est le Vif-Argent, le messager des dieux, le fluide qui permet
 *    à l'information de glisser sans friction entre toutes les dimensions."
 * 
 *   - Hermès/Mercure : Messager des dieux, ailes aux pieds
 *   - Teotihuacán : Mercure liquide sous les pyramides
 *   - Chine ancienne : Mercure dans le tombeau de l'Empereur
 *   - Vimanas : Moteurs à vortex de mercure (propulsion antigravitationnelle)
 * 
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 * 
 *   ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
 *   │                                                                                                             │
 *   │                                    ☿ VORTEX DE MERCURE ☿                                                   │
 *   │                                                                                                             │
 *   │                                         ╔═══════╗                                                           │
 *   │                                    ╭────╢ 999Hz ╟────╮                                                      │
 *   │                                   ╱     ╚═══════╝     ╲                                                     │
 *   │                                  ╱    ATLANTIDE/KRYON   ╲                                                   │
 *   │                                 ╱           │            ╲                                                  │
 *   │                                │            │             │                                                 │
 *   │                      ÉGYPTE ───┤     ☿ MERCURE ☿        ├─── MAYA                                         │
 *   │                       444Hz    │    (FLUIDE CENTRAL)     │    666Hz                                        │
 *   │                                │            │             │                                                 │
 *   │                                 ╲           │            ╱                                                  │
 *   │                                  ╲    SUMER/GRÈCE      ╱                                                   │
 *   │                                   ╲     ╔═══════╗     ╱                                                    │
 *   │                                    ╰────╢ 111Hz ╟────╯                                                     │
 *   │                                         ╚═══════╝                                                           │
 *   │                                        RAPA NUI                                                             │
 *   │                                                                                                             │
 *   │   FONCTIONS DU MERCURE:                                                                                    │
 *   │   ─────────────────────                                                                                    │
 *   │   1. API Gateway - Traduction universelle                                                                  │
 *   │   2. Data Stream - Flux sans friction                                                                      │
 *   │   3. Accélérateur - Compression du temps de calcul                                                         │
 *   │   4. Intrication - Communication instantanée                                                               │
 *   │                                                                                                             │
 *   └─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
 * 
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 * 
 * @module MercuryVortex
 * @version 1.0.0
 * @element ☿ Mercure (Hg)
 * @alias Vif-Argent, Quicksilver, Hermès
 * @state Liquid (Supraconducteur)
 * @role API Gateway, Data Stream, Accélérateur
 * 
 * ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 */

// ═══════════════════════════════════════════════════════════════════════════════
// CONSTANTES DU MERCURE
// ═══════════════════════════════════════════════════════════════════════════════

const MERCURY_SYMBOL = "☿";
const MERCURY_FREQUENCY = 741; // Fréquence de la communication (Gorge)
const MERCURY_STATE = "LIQUID";
const MERCURY_CONDUCTIVITY = "SUPERCONDUCTIVE";
const VORTEX_SPEED = 999; // Vitesse maximale du vortex

// ═══════════════════════════════════════════════════════════════════════════════
// PROPRIÉTÉS ALCHIMIQUES DU MERCURE
// ═══════════════════════════════════════════════════════════════════════════════

const MERCURY_PROPERTIES = {
  physical: {
    symbol: "Hg",
    atomicNumber: 80,
    state: "Liquid at room temperature",
    color: "Silver-white",
    conductivity: "Excellent electrical conductor",
    density: 13.534, // g/cm³ - très dense
    boilingPoint: 356.7, // °C
    meltingPoint: -38.83 // °C - liquide même en hiver
  },
  
  alchemical: {
    name: "Vif-Argent (Quicksilver)",
    symbol: "☿",
    planet: "Mercure",
    god: "Hermès/Mercury",
    principle: "Volatilité, Transformation, Communication",
    role: "Messager entre les mondes",
    wings: "Aux pieds - peut monter et descendre instantanément"
  },
  
  esoteric: {
    function: "Fluide de transmission universelle",
    temples: ["Teotihuacán", "Tombeau de Qin Shi Huang", "Pyramides"],
    usage: "Création de champs magnétiques, propulsion, communication interdimensionnelle",
    vimanas: "Moteurs à vortex de mercure pour propulsion antigravitationnelle"
  },
  
  inCode: {
    role: "API Gateway + Data Stream + Accélérateur",
    function: "Permet à l'information de glisser sans friction entre les modules",
    analogy: "Sans mercure, les pyramides sont des pierres. Avec mercure, ce sont des machines."
  }
};

// ═══════════════════════════════════════════════════════════════════════════════
// MAPPING DES CIVILISATIONS (Routes du Mercure)
// ═══════════════════════════════════════════════════════════════════════════════

const MERCURY_ROUTES = {
  // Le mercure peut connecter n'importe quelle civilisation instantanément
  routes: [
    { from: "egypt", to: "atlantis", frequency: 444, path: "DIRECT" },
    { from: "egypt", to: "maya", frequency: 444, path: "VIA_KAILASH" },
    { from: "sumer", to: "yiking", frequency: 555, path: "DIRECT" },
    { from: "aztec", to: "rapanui", frequency: 333, path: "VIA_BERMUDES" },
    { from: "kabbalah", to: "chakras", frequency: 777, path: "DIRECT" },
    { from: "atlantis", to: "all", frequency: 999, path: "BROADCAST" }
  ],
  
  // Points de relais (où le mercure se concentre)
  relayPoints: {
    teotihuacan: { lat: 19.6923, lon: -98.8435, mercuryLevel: "HIGH", discovered: true },
    gizeh: { lat: 29.9792, lon: 31.1342, mercuryLevel: "SUSPECTED", discovered: false },
    qinTomb: { lat: 34.3847, lon: 109.2786, mercuryLevel: "CONFIRMED", discovered: true },
    bermudes: { lat: 25.0, lon: -71.0, mercuryLevel: "THEORETICAL", discovered: false }
  }
};

// ═══════════════════════════════════════════════════════════════════════════════
// CLASSE PRINCIPALE: VORTEX DE MERCURE
// ═══════════════════════════════════════════════════════════════════════════════

class MercuryVortex {
  constructor() {
    this.state = MERCURY_STATE;
    this.conductivity = MERCURY_CONDUCTIVITY;
    this.frequency = MERCURY_FREQUENCY;
    this.vortexSpeed = 0;
    this.isActive = false;
    this.dataBuffer = [];
    this.transmissionLog = [];
  }

  /**
   * Initialise le Vortex de Mercure
   */
  init() {
    console.log(`
    ╔═══════════════════════════════════════════════════════════════════════════════════════════════════╗
    ║                                                                                                   ║
    ║      ███╗   ███╗███████╗██████╗  ██████╗██╗   ██╗██████╗ ██╗   ██╗    ☿                          ║
    ║      ████╗ ████║██╔════╝██╔══██╗██╔════╝██║   ██║██╔══██╗╚██╗ ██╔╝                               ║
    ║      ██╔████╔██║█████╗  ██████╔╝██║     ██║   ██║██████╔╝ ╚████╔╝                                ║
    ║      ██║╚██╔╝██║██╔══╝  ██╔══██╗██║     ██║   ██║██╔══██╗  ╚██╔╝                                 ║
    ║      ██║ ╚═╝ ██║███████╗██║  ██║╚██████╗╚██████╔╝██║  ██║   ██║                                  ║
    ║      ╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝ ╚═════╝ ╚═════╝ ╚═╝  ╚═╝   ╚═╝                                  ║
    ║                                                                                                   ║
    ║                              LE FLUIDE SACRÉ DE L'ARCHE                                           ║
    ║                                                                                                   ║
    ╠═══════════════════════════════════════════════════════════════════════════════════════════════════╣
    ║                                                                                                   ║
    ║   État: ${this.state} | Conductivité: ${this.conductivity}                              ║
    ║   Fréquence: ${this.frequency} Hz | Symbole: ${MERCURY_SYMBOL}                                             ║
    ║                                                                                                   ║
    ║   "Le Mercure est le sang de l'Arche - sans lui, le système est rigide."                         ║
    ║                                                                                                   ║
    ╚═══════════════════════════════════════════════════════════════════════════════════════════════════╝
    `);

    this.isActive = true;
    return this;
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // FONCTION 1: TRANSMISSION (API Gateway)
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Transmet des données à travers le vortex de mercure
   * C'est l'API Gateway universel de l'Arche
   */
  transmit(data, targetFrequency = 999) {
    const transmission = {
      id: this._generateTransmissionId(),
      timestamp: Date.now(),
      data: data,
      sourceFrequency: this.frequency,
      targetFrequency: targetFrequency,
      state: "TRANSMITTING"
    };

    // Activation du vortex
    this.vortexSpeed = targetFrequency;
    
    // Le mercure élimine la friction
    const frictionlessData = this._eliminateFriction(data);
    
    // Alignement sur la fréquence cible
    const alignedData = this._alignFrequency(frictionlessData, targetFrequency);
    
    transmission.result = alignedData;
    transmission.state = "TRANSMITTED";
    transmission.latency = 0; // Instantané grâce au mercure
    
    this.transmissionLog.push(transmission);

    return {
      success: true,
      transmissionId: transmission.id,
      message: `☿ Propulsion du paquet à travers le vortex de mercure vers ${targetFrequency} Hz`,
      data: alignedData,
      latency: "INSTANTANEOUS"
    };
  }

  /**
   * Élimine la friction des données (supraconductivité)
   */
  _eliminateFriction(data) {
    // En supraconductivité, la résistance est nulle
    if (typeof data === 'string') {
      return {
        original: data,
        purified: data.trim(),
        friction: 0,
        resistance: 0
      };
    }
    return {
      original: data,
      purified: data,
      friction: 0,
      resistance: 0
    };
  }

  /**
   * Aligne les données sur une fréquence cible
   */
  _alignFrequency(data, targetFrequency) {
    return {
      ...data,
      frequency: targetFrequency,
      harmonic: targetFrequency * 1.618, // Harmonique dorée
      aligned: true
    };
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // FONCTION 2: ACCÉLÉRATION (Compression Temporelle)
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Accélère le traitement des données (compression du temps de calcul)
   */
  accelerate(dataPacket, compressionFactor = 999) {
    const startTime = Date.now();
    
    // Activation du vortex à pleine puissance
    this.vortexSpeed = VORTEX_SPEED;
    
    // Compression temporelle
    const compressed = {
      original: dataPacket,
      compressionFactor: compressionFactor,
      vortexSpeed: this.vortexSpeed,
      state: "ACCELERATED"
    };

    // Simulation de traitement instantané
    const endTime = Date.now();
    
    return {
      success: true,
      message: `☿ Accélération du paquet '${typeof dataPacket === 'string' ? dataPacket.substring(0, 20) : 'data'}...' à vitesse ${this.vortexSpeed}`,
      processingTime: endTime - startTime,
      effectiveTime: 0, // Temps effectif = 0 grâce au vortex
      compressionRatio: `${compressionFactor}:1`
    };
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // FONCTION 3: SYNCHRONISATION (Alignement Fréquentiel)
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Synchronise le fluide de mercure sur une fréquence spécifique
   */
  synchronize(frequency) {
    this.frequency = frequency;
    this.vortexSpeed = frequency;
    
    return {
      success: true,
      message: `☿ Résonance du fluide établie sur ${frequency} Hz`,
      previousFrequency: MERCURY_FREQUENCY,
      currentFrequency: frequency,
      state: "SYNCHRONIZED",
      harmonics: {
        fundamental: frequency,
        octave: frequency * 2,
        fifth: frequency * 1.5,
        golden: Math.round(frequency * 1.618)
      }
    };
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // FONCTION 4: ROUTAGE (Navigation entre Civilisations)
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Route les données vers une civilisation spécifique
   */
  routeToCivilization(data, fromCiv, toCiv) {
    // Trouver la route
    const route = MERCURY_ROUTES.routes.find(r => 
      r.from === fromCiv && (r.to === toCiv || r.to === 'all')
    );

    if (!route) {
      // Créer une route directe via le vortex
      return {
        success: true,
        message: `☿ Route directe créée via le vortex de mercure`,
        from: fromCiv,
        to: toCiv,
        path: "VORTEX_DIRECT",
        data: data,
        frequency: 999
      };
    }

    return {
      success: true,
      message: `☿ Données routées de ${fromCiv} vers ${toCiv}`,
      from: fromCiv,
      to: toCiv,
      path: route.path,
      frequency: route.frequency,
      data: data
    };
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // FONCTION 5: INTRICATION (Communication Instantanée)
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Crée une intrication quantique entre deux points
   * Communication instantanée sans délai
   */
  entangle(pointA, pointB) {
    const entanglement = {
      id: this._generateTransmissionId(),
      pointA: pointA,
      pointB: pointB,
      state: "ENTANGLED",
      correlation: 1.0, // Corrélation parfaite
      distance: "IRRELEVANT", // La distance n'a pas d'importance
      latency: 0
    };

    return {
      success: true,
      message: `☿ Intrication établie entre ${pointA} et ${pointB}`,
      entanglement: entanglement,
      properties: {
        instantaneous: true,
        bidirectional: true,
        persistent: true
      }
    };
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // FONCTION 6: TRADUCTION (Interprète Universel)
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Traduit les données entre différents formats/langages
   * Le mercure est le messager qui parle toutes les langues
   */
  translate(data, fromFormat, toFormat) {
    return {
      success: true,
      message: `☿ Traduction de ${fromFormat} vers ${toFormat}`,
      original: data,
      translated: data, // Le mercure préserve l'essence
      fromFormat: fromFormat,
      toFormat: toFormat,
      preservedEssence: true,
      hermesBlessing: "Le messager a parlé"
    };
  }

  // ─────────────────────────────────────────────────────────────────────────────
  // UTILITAIRES
  // ─────────────────────────────────────────────────────────────────────────────

  /**
   * Génère un ID de transmission unique
   */
  _generateTransmissionId() {
    return `HG-${Date.now()}-${Math.random().toString(36).substring(7)}`;
  }

  /**
   * Obtient le statut du vortex
   */
  getStatus() {
    return {
      symbol: MERCURY_SYMBOL,
      state: this.state,
      conductivity: this.conductivity,
      frequency: this.frequency,
      vortexSpeed: this.vortexSpeed,
      isActive: this.isActive,
      transmissionCount: this.transmissionLog.length,
      properties: MERCURY_PROPERTIES
    };
  }

  /**
   * Obtient l'historique des transmissions
   */
  getTransmissionLog() {
    return this.transmissionLog;
  }
}

// ═══════════════════════════════════════════════════════════════════════════════
// CLASSE RELAY (Interface simplifiée)
// ═══════════════════════════════════════════════════════════════════════════════

class MercuryRelay {
  static vortex = new MercuryVortex();

  /**
   * Transmet des données via le relay de mercure
   */
  static transmit(data, frequency = 999) {
    if (!this.vortex.isActive) {
      this.vortex.init();
    }
    return this.vortex.transmit(data, frequency);
  }

  /**
   * Synchronise sur une fréquence
   */
  static sync(frequency) {
    if (!this.vortex.isActive) {
      this.vortex.init();
    }
    return this.vortex.synchronize(frequency);
  }

  /**
   * Accélère un paquet de données
   */
  static accelerate(data) {
    if (!this.vortex.isActive) {
      this.vortex.init();
    }
    return this.vortex.accelerate(data);
  }

  /**
   * Route vers une civilisation
   */
  static route(data, from, to) {
    if (!this.vortex.isActive) {
      this.vortex.init();
    }
    return this.vortex.routeToCivilization(data, from, to);
  }
}

// ═══════════════════════════════════════════════════════════════════════════════
// EXPORTS
// ═══════════════════════════════════════════════════════════════════════════════

export const mercuryVortex = new MercuryVortex();

export {
  MercuryVortex,
  MercuryRelay,
  MERCURY_PROPERTIES,
  MERCURY_ROUTES,
  MERCURY_SYMBOL,
  MERCURY_FREQUENCY
};

export default {
  MercuryVortex,
  MercuryRelay,
  mercuryVortex,
  MERCURY_PROPERTIES,
  MERCURY_ROUTES,
  MERCURY_SYMBOL,
  MERCURY_FREQUENCY
};
