# ğŸ“ˆ CHEÂ·NUâ„¢ â€” SYSTÃˆME DE PROGRESSION UTILISATEUR

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘           ğŸ“ˆ USER PROGRESSION SYSTEM â€” TRACKING COMPLET                     â•‘
â•‘                                                                              â•‘
â•‘     "Chaque utilisateur a son chemin â€” Nova le comprend"                    â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Version**: 1.0
**Date**: 23 DÃ©cembre 2025

---

# 1. MODÃˆLE DE PROGRESSION

## 1.1 Ã‰tats de Progression Globale

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ã‰TATS DE PROGRESSION UTILISATEUR                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  NEWCOMER   â”‚â”€â”€â–¶â”‚  EXPLORER   â”‚â”€â”€â–¶â”‚   ACTIVE    â”‚â”€â”€â–¶â”‚   EXPERT    â”‚    â”‚
â”‚  â”‚   (0-7j)    â”‚   â”‚   (7-30j)   â”‚   â”‚  (30-90j)   â”‚   â”‚   (90j+)    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â”‚  NEWCOMER:                                                                  â”‚
â”‚  â€¢ DÃ©couverte initiale                                                      â”‚
â”‚  â€¢ Tutoriels systÃ¨me                                                        â”‚
â”‚  â€¢ Nova trÃ¨s prÃ©sente                                                       â”‚
â”‚  â€¢ Questions minimales                                                      â”‚
â”‚                                                                             â”‚
â”‚  EXPLORER:                                                                  â”‚
â”‚  â€¢ Exploration des sphÃ¨res                                                  â”‚
â”‚  â€¢ Tutoriels contextuels                                                    â”‚
â”‚  â€¢ Nova guide modÃ©rÃ©ment                                                    â”‚
â”‚  â€¢ Questions contextuelles                                                  â”‚
â”‚                                                                             â”‚
â”‚  ACTIVE:                                                                    â”‚
â”‚  â€¢ Usage rÃ©gulier                                                           â”‚
â”‚  â€¢ Tutoriels avancÃ©s                                                        â”‚
â”‚  â€¢ Nova en support                                                          â”‚
â”‚  â€¢ Questions d'optimisation                                                 â”‚
â”‚                                                                             â”‚
â”‚  EXPERT:                                                                    â”‚
â”‚  â€¢ MaÃ®trise du systÃ¨me                                                      â”‚
â”‚  â€¢ Features avancÃ©es                                                        â”‚
â”‚  â€¢ Nova discrÃ¨te                                                            â”‚
â”‚  â€¢ Questions rares                                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1.2 CritÃ¨res de Transition

```typescript
interface ProgressionCriteria {
  newcomerToExplorer: {
    minDays: 7;
    OR: {
      tutorialsCompleted: 3;
      spheresVisited: 2;
      actionsPerformed: 20;
    };
  };
  
  explorerToActive: {
    minDays: 30;
    AND: {
      tutorialsCompleted: 10;
      spheresActive: 2;      // Usage rÃ©gulier dans 2+ sphÃ¨res
      piecesCollected: 20;
      sessionsPerWeek: 3;
    };
  };
  
  activeToExpert: {
    minDays: 90;
    AND: {
      tutorialsCompleted: 30;
      featuresUnlocked: 15;
      piecesCollected: 50;
      advancedFeaturesUsed: 5;
      sessionsPerWeek: 5;
    };
  };
}
```

---

# 2. SCORE DE COMPLÃ‰TION

## 2.1 Calcul du Score Global

```typescript
interface UserProgressionScore {
  // Score global (0-100)
  globalScore: number;
  
  // Sous-scores
  scores: {
    puzzleCompletion: number;      // % piÃ¨ces collectÃ©es
    tutorialProgress: number;      // % tutoriels complÃ©tÃ©s
    featureAdoption: number;       // % features utilisÃ©es
    sphereBalance: number;         // Ã‰quilibre usage sphÃ¨res
    engagementLevel: number;       // RÃ©gularitÃ© sessions
  };
  
  // Niveau
  level: 'newcomer' | 'explorer' | 'active' | 'expert';
  
  // Progression vers niveau suivant
  nextLevelProgress: number;       // 0-100%
  
  // MÃ©triques dÃ©taillÃ©es
  metrics: {
    totalPieces: number;
    collectedPieces: number;
    totalTutorials: number;
    completedTutorials: number;
    totalFeatures: number;
    usedFeatures: number;
    daysActive: number;
    lastSessionDate: Date;
  };
}
```

## 2.2 Formule de Calcul

```typescript
function calculateProgressionScore(userId: string): UserProgressionScore {
  const metrics = getUserMetrics(userId);
  
  // Calcul des sous-scores
  const puzzleCompletion = (metrics.collectedPieces / metrics.totalPieces) * 100;
  const tutorialProgress = (metrics.completedTutorials / metrics.totalTutorials) * 100;
  const featureAdoption = (metrics.usedFeatures / metrics.totalFeatures) * 100;
  const sphereBalance = calculateSphereBalance(userId);
  const engagementLevel = calculateEngagement(userId);
  
  // PondÃ©ration pour score global
  const globalScore = (
    puzzleCompletion * 0.25 +
    tutorialProgress * 0.20 +
    featureAdoption * 0.25 +
    sphereBalance * 0.15 +
    engagementLevel * 0.15
  );
  
  return {
    globalScore,
    scores: {
      puzzleCompletion,
      tutorialProgress,
      featureAdoption,
      sphereBalance,
      engagementLevel,
    },
    level: determineLevel(metrics),
    nextLevelProgress: calculateNextLevelProgress(metrics),
    metrics,
  };
}
```

---

# 3. TRACKING PAR SPHÃˆRE

## 3.1 Progression par SphÃ¨re

```typescript
interface SphereProgression {
  sphereId: string;
  sphereName: string;
  
  // Ã‰tat
  status: 'locked' | 'discovered' | 'exploring' | 'active' | 'mastered';
  
  // MÃ©triques
  metrics: {
    firstVisit: Date | null;
    lastVisit: Date | null;
    totalVisits: number;
    timeSpentMinutes: number;
    actionsPerformed: number;
  };
  
  // PiÃ¨ces
  puzzle: {
    totalPieces: number;
    collectedPieces: number;
    essentialPieces: number;
    essentialCollected: number;
  };
  
  // Tutoriels
  tutorials: {
    totalAvailable: number;
    unlocked: number;
    completed: number;
    inProgress: number;
  };
  
  // Features
  features: {
    totalAvailable: number;
    unlocked: number;
    used: number;
  };
  
  // Score sphÃ¨re (0-100)
  sphereScore: number;
}
```

## 3.2 Tableau de Bord Progression

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    TABLEAU DE BORD PROGRESSION                               â•‘
â•‘                         (Exemple Utilisateur)                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  NIVEAU GLOBAL: EXPLORER                    SCORE: 45/100                   â•‘
â•‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 45%          â•‘
â•‘                                                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ SPHÃˆRE          â”‚ STATUT     â”‚ PIÃˆCES  â”‚ TUTORIELS â”‚ FEATURES â”‚ SCORE â”‚ â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘
â•‘  â”‚ ğŸ  Personal     â”‚ Active     â”‚ 6/12    â”‚ 4/8       â”‚ 8/15     â”‚  62   â”‚ â•‘
â•‘  â”‚ ğŸ’¼ Business     â”‚ Exploring  â”‚ 8/18    â”‚ 3/12      â”‚ 5/20     â”‚  41   â”‚ â•‘
â•‘  â”‚ ğŸ›ï¸ Government   â”‚ Discovered â”‚ 1/8     â”‚ 0/5       â”‚ 0/10     â”‚  12   â”‚ â•‘
â•‘  â”‚ ğŸ¨ Creative     â”‚ Locked     â”‚ 0/10    â”‚ 0/6       â”‚ 0/12     â”‚   0   â”‚ â•‘
â•‘  â”‚ ğŸ‘¥ Community    â”‚ Locked     â”‚ 0/8     â”‚ 0/5       â”‚ 0/10     â”‚   0   â”‚ â•‘
â•‘  â”‚ ğŸ“± Social       â”‚ Locked     â”‚ 0/6     â”‚ 0/4       â”‚ 0/8      â”‚   0   â”‚ â•‘
â•‘  â”‚ ğŸ¬ Entertainmentâ”‚ Discovered â”‚ 2/6     â”‚ 1/4       â”‚ 2/8      â”‚  25   â”‚ â•‘
â•‘  â”‚ ğŸ¤ My Team      â”‚ Locked     â”‚ 0/10    â”‚ 0/8       â”‚ 0/15     â”‚   0   â”‚ â•‘
â•‘  â”‚ ğŸ“š Scholar      â”‚ Locked     â”‚ 0/8     â”‚ 0/5       â”‚ 0/10     â”‚   0   â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•‘  PROGRESSION VERS NIVEAU SUIVANT (Active):                                   â•‘
â•‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 68%           â•‘
â•‘                                                                              â•‘
â•‘  â€¢ Tutoriels complÃ©tÃ©s: 8/10 âœ“                                              â•‘
â•‘  â€¢ SphÃ¨res actives: 1/2 (besoin: 1 de plus)                                 â•‘
â•‘  â€¢ PiÃ¨ces collectÃ©es: 17/20 (besoin: 3 de plus)                             â•‘
â•‘  â€¢ Sessions/semaine: 4/3 âœ“                                                  â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

# 4. MILESTONES & ACHIEVEMENTS

## 4.1 SystÃ¨me de Milestones

```typescript
interface Milestone {
  id: string;
  category: 'onboarding' | 'puzzle' | 'tutorial' | 'feature' | 'engagement';
  
  // DÃ©finition
  name: { fr: string; en: string };
  description: { fr: string; en: string };
  icon: string;
  
  // Condition
  condition: MilestoneCondition;
  
  // RÃ©compense
  reward?: {
    unlocks?: string[];        // IDs features/tutoriels
    novaMessage?: { fr: string; en: string };
    celebration?: 'confetti' | 'badge' | 'notification';
  };
  
  // Ã‰tat
  status: 'locked' | 'in_progress' | 'achieved';
  achievedAt?: Date;
}

type MilestoneCondition = 
  | { type: 'piece_count'; count: number }
  | { type: 'tutorial_count'; count: number }
  | { type: 'feature_used'; featureId: string }
  | { type: 'days_active'; days: number }
  | { type: 'sphere_mastered'; sphereId: string }
  | { type: 'custom'; check: (user: User) => boolean };
```

## 4.2 Liste des Milestones

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         MILESTONES CHEÂ·NU                                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  ONBOARDING                                                                  â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â•‘
â•‘  ğŸ¯ Premier Pas         â”‚ ComplÃ©ter tutoriel bienvenue                      â•‘
â•‘  ğŸ” Explorateur         â”‚ Visiter 3 sphÃ¨res diffÃ©rentes                     â•‘
â•‘  ğŸ“ PremiÃ¨re Note       â”‚ CrÃ©er premiÃ¨re note                               â•‘
â•‘  âœ… PremiÃ¨re TÃ¢che      â”‚ CrÃ©er premiÃ¨re tÃ¢che                              â•‘
â•‘  ğŸ’¬ Premier Thread      â”‚ CrÃ©er premier thread                              â•‘
â•‘                                                                              â•‘
â•‘  PUZZLE                                                                      â•‘
â•‘  â”€â”€â”€â”€â”€â”€                                                                      â•‘
â•‘  ğŸ§© Collectionneur      â”‚ 10 piÃ¨ces collectÃ©es                              â•‘
â•‘  ğŸ§© Puzzle Master       â”‚ 25 piÃ¨ces collectÃ©es                              â•‘
â•‘  ğŸ§© Puzzle Legend       â”‚ 50 piÃ¨ces collectÃ©es                              â•‘
â•‘  ğŸ¯ Profil Complet      â”‚ Toutes piÃ¨ces essentielles d'une sphÃ¨re          â•‘
â•‘                                                                              â•‘
â•‘  TUTORIELS                                                                   â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â•‘
â•‘  ğŸ“š Ã‰tudiant            â”‚ 5 tutoriels complÃ©tÃ©s                             â•‘
â•‘  ğŸ“š DiplÃ´mÃ©             â”‚ 15 tutoriels complÃ©tÃ©s                            â•‘
â•‘  ğŸ“š Expert              â”‚ 30 tutoriels complÃ©tÃ©s                            â•‘
â•‘  ğŸ“ MaÃ®tre              â”‚ Tous tutoriels d'une sphÃ¨re                       â•‘
â•‘                                                                              â•‘
â•‘  FEATURES                                                                    â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€                                                                    â•‘
â•‘  âš¡ Power User          â”‚ 10 features utilisÃ©es                              â•‘
â•‘  âš¡ Super User          â”‚ 25 features utilisÃ©es                              â•‘
â•‘  ğŸ”“ DÃ©bloqueur          â”‚ PremiÃ¨re feature dÃ©bloquÃ©e par piÃ¨ce             â•‘
â•‘  ğŸŒŸ Feature Master      â”‚ Toutes features d'un module                       â•‘
â•‘                                                                              â•‘
â•‘  ENGAGEMENT                                                                  â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                  â•‘
â•‘  ğŸ“… 7 Jours             â”‚ 7 jours consÃ©cutifs d'utilisation                 â•‘
â•‘  ğŸ“… 30 Jours            â”‚ 30 jours consÃ©cutifs d'utilisation                â•‘
â•‘  ğŸ“… FidÃ¨le              â”‚ 3 mois d'utilisation active                       â•‘
â•‘  ğŸ  MaÃ®tre de SphÃ¨re    â”‚ Score 90+ dans une sphÃ¨re                         â•‘
â•‘                                                                              â•‘
â•‘  DOMAINES                                                                    â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€                                                                    â•‘
â•‘  ğŸ—ï¸ Pro Construction    â”‚ Module Construction maÃ®trisÃ©                      â•‘
â•‘  ğŸ¢ Pro Immobilier      â”‚ Module Immobilier maÃ®trisÃ©                        â•‘
â•‘  ğŸ¨ Pro CrÃ©atif         â”‚ SphÃ¨re Creative maÃ®trisÃ©e                         â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

# 5. ANALYTICS & REPORTING

## 5.1 MÃ©triques Utilisateur

```typescript
interface UserAnalytics {
  userId: string;
  
  // ActivitÃ©
  activity: {
    totalSessions: number;
    totalTimeMinutes: number;
    averageSessionMinutes: number;
    lastActiveAt: Date;
    streakDays: number;
    longestStreak: number;
  };
  
  // Engagement
  engagement: {
    actionsPerSession: number;
    featuresUsedPerSession: number;
    tutorialsStartedVsCompleted: number; // Ratio
    questionsAnsweredVsSkipped: number;  // Ratio
  };
  
  // Progression
  progression: {
    currentLevel: string;
    daysToNextLevel: number | null;
    progressionVelocity: number; // PiÃ¨ces/semaine
  };
  
  // PrÃ©fÃ©rences dÃ©tectÃ©es
  preferences: {
    preferredSpheres: string[];
    preferredTimeOfDay: 'morning' | 'afternoon' | 'evening' | 'night';
    preferredDevice: 'desktop' | 'mobile' | 'tablet';
    communicationStyle: 'minimal' | 'balanced' | 'detailed';
  };
  
  // Risques
  risks: {
    churnRisk: 'low' | 'medium' | 'high';
    lastRiskAssessment: Date;
    inactiveDays: number;
    engagementTrend: 'increasing' | 'stable' | 'decreasing';
  };
}
```

## 5.2 Tableau de Bord Admin

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ANALYTICS PROGRESSION â€” VUE ADMIN                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  DISTRIBUTION DES NIVEAUX                         PÃ‰RIODE: 30 derniers joursâ•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                                                                        â”‚ â•‘
â•‘  â”‚  Newcomer   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  35%        â”‚ â•‘
â•‘  â”‚  Explorer   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  28%        â”‚ â•‘
â•‘  â”‚  Active     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  22%        â”‚ â•‘
â•‘  â”‚  Expert     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  15%        â”‚ â•‘
â•‘  â”‚                                                                        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•‘  MÃ‰TRIQUES CLÃ‰S                                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                                                                        â”‚ â•‘
â•‘  â”‚  PiÃ¨ces collectÃ©es/user      â”‚ 23.4     â”‚ â–² +12% vs mois dernier      â”‚ â•‘
â•‘  â”‚  Tutoriels complÃ©tÃ©s/user    â”‚ 8.2      â”‚ â–² +8%  vs mois dernier      â”‚ â•‘
â•‘  â”‚  Questions rÃ©pondues         â”‚ 67%      â”‚ â–¼ -3%  vs mois dernier      â”‚ â•‘
â•‘  â”‚  Temps progression Newcomerâ†’Explorer  â”‚ 12 jours â”‚ â–² -2j amÃ©lioration â”‚ â•‘
â•‘  â”‚                                                                        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•‘  TUTORIELS LES PLUS COMPLÃ‰TÃ‰S                                               â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  1. TUT-000 Bienvenue           â”‚ 98% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚ â•‘
â•‘  â”‚  2. TUT-001 SphÃ¨res             â”‚ 89% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â”‚ â•‘
â•‘  â”‚  3. TUT-B01 Facturation         â”‚ 72% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         â”‚ â•‘
â•‘  â”‚  4. TUT-003 Threads             â”‚ 68% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ           â”‚ â•‘
â•‘  â”‚  5. TUT-P01 Budget              â”‚ 54% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ               â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•‘  TUTORIELS LES PLUS SKIPPÃ‰S                                                 â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  1. TUT-CON-RBQ-ADV             â”‚ 45% skip â”‚ âš ï¸ Revoir contenu?        â”‚ â•‘
â•‘  â”‚  2. TUT-B-TEAM-L                â”‚ 38% skip â”‚                           â”‚ â•‘
â•‘  â”‚  3. TUT-IMM-PORT                â”‚ 32% skip â”‚                           â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•‘  QUESTIONS LES PLUS SKIPPÃ‰ES                                                â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  1. Q-PROJ-002 MÃ©thodologie     â”‚ 52% skip â”‚ Timing? Reformuler?       â”‚ â•‘
â•‘  â”‚  2. Q-DASH-002 DensitÃ©          â”‚ 41% skip â”‚                           â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

# 6. SCHÃ‰MA BASE DE DONNÃ‰ES PROGRESSION

```sql
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- TABLES PROGRESSION UTILISATEUR
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ã‰tat de progression global
CREATE TABLE user_progression (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) UNIQUE,
    
    -- Niveau
    level VARCHAR(20) DEFAULT 'newcomer',
    level_achieved_at TIMESTAMP,
    
    -- Score global
    global_score INTEGER DEFAULT 0,
    
    -- Sous-scores
    puzzle_score INTEGER DEFAULT 0,
    tutorial_score INTEGER DEFAULT 0,
    feature_score INTEGER DEFAULT 0,
    sphere_score INTEGER DEFAULT 0,
    engagement_score INTEGER DEFAULT 0,
    
    -- MÃ©triques
    total_pieces_collected INTEGER DEFAULT 0,
    total_tutorials_completed INTEGER DEFAULT 0,
    total_features_used INTEGER DEFAULT 0,
    total_sessions INTEGER DEFAULT 0,
    total_time_minutes INTEGER DEFAULT 0,
    
    -- Streak
    current_streak_days INTEGER DEFAULT 0,
    longest_streak_days INTEGER DEFAULT 0,
    last_active_date DATE,
    
    -- Timestamps
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- Progression par sphÃ¨re
CREATE TABLE user_sphere_progression (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id),
    sphere_id VARCHAR(50) NOT NULL,
    
    -- Ã‰tat
    status VARCHAR(20) DEFAULT 'locked',
    
    -- MÃ©triques
    first_visit_at TIMESTAMP,
    last_visit_at TIMESTAMP,
    total_visits INTEGER DEFAULT 0,
    time_spent_minutes INTEGER DEFAULT 0,
    actions_performed INTEGER DEFAULT 0,
    
    -- Puzzle
    pieces_total INTEGER DEFAULT 0,
    pieces_collected INTEGER DEFAULT 0,
    essential_pieces_total INTEGER DEFAULT 0,
    essential_pieces_collected INTEGER DEFAULT 0,
    
    -- Tutoriels
    tutorials_available INTEGER DEFAULT 0,
    tutorials_unlocked INTEGER DEFAULT 0,
    tutorials_completed INTEGER DEFAULT 0,
    
    -- Features
    features_available INTEGER DEFAULT 0,
    features_unlocked INTEGER DEFAULT 0,
    features_used INTEGER DEFAULT 0,
    
    -- Score
    sphere_score INTEGER DEFAULT 0,
    
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    
    UNIQUE(user_id, sphere_id)
);

-- Milestones utilisateur
CREATE TABLE user_milestones (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id),
    milestone_id VARCHAR(100) NOT NULL,
    
    -- Ã‰tat
    status VARCHAR(20) DEFAULT 'locked',
    progress INTEGER DEFAULT 0,      -- Progression 0-100
    
    -- Achievement
    achieved_at TIMESTAMP,
    
    -- RÃ©compenses accordÃ©es
    rewards_granted BOOLEAN DEFAULT FALSE,
    
    created_at TIMESTAMP DEFAULT NOW(),
    
    UNIQUE(user_id, milestone_id)
);

-- Historique de progression (pour analytics)
CREATE TABLE progression_history (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id),
    
    -- Snapshot
    snapshot_date DATE NOT NULL,
    level VARCHAR(20),
    global_score INTEGER,
    
    -- DÃ©tail scores
    scores JSONB,
    
    -- MÃ©triques du jour
    daily_metrics JSONB,
    
    created_at TIMESTAMP DEFAULT NOW(),
    
    UNIQUE(user_id, snapshot_date)
);

-- Index
CREATE INDEX idx_progression_level ON user_progression(level);
CREATE INDEX idx_progression_score ON user_progression(global_score DESC);
CREATE INDEX idx_sphere_progression_status ON user_sphere_progression(status);
CREATE INDEX idx_milestones_achieved ON user_milestones(achieved_at) WHERE achieved_at IS NOT NULL;

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- FONCTIONS
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Recalcul du score global
CREATE OR REPLACE FUNCTION recalculate_progression_score(p_user_id UUID)
RETURNS void AS $$
DECLARE
    v_puzzle_score INTEGER;
    v_tutorial_score INTEGER;
    v_feature_score INTEGER;
    v_sphere_score INTEGER;
    v_engagement_score INTEGER;
    v_global_score INTEGER;
BEGIN
    -- Calculer puzzle score
    SELECT COALESCE(
        (SUM(pieces_collected)::FLOAT / NULLIF(SUM(pieces_total), 0) * 100)::INTEGER,
        0
    ) INTO v_puzzle_score
    FROM user_sphere_progression
    WHERE user_id = p_user_id;
    
    -- Calculer tutorial score
    SELECT COALESCE(
        (SUM(tutorials_completed)::FLOAT / NULLIF(SUM(tutorials_available), 0) * 100)::INTEGER,
        0
    ) INTO v_tutorial_score
    FROM user_sphere_progression
    WHERE user_id = p_user_id;
    
    -- Calculer feature score
    SELECT COALESCE(
        (SUM(features_used)::FLOAT / NULLIF(SUM(features_available), 0) * 100)::INTEGER,
        0
    ) INTO v_feature_score
    FROM user_sphere_progression
    WHERE user_id = p_user_id;
    
    -- Calculer sphere balance score
    SELECT COALESCE(
        (COUNT(CASE WHEN status IN ('active', 'mastered') THEN 1 END)::FLOAT / 
         NULLIF(COUNT(*), 0) * 100)::INTEGER,
        0
    ) INTO v_sphere_score
    FROM user_sphere_progression
    WHERE user_id = p_user_id;
    
    -- Calculer engagement (basÃ© sur streak et rÃ©gularitÃ©)
    SELECT COALESCE(
        LEAST(current_streak_days * 5, 100),
        0
    ) INTO v_engagement_score
    FROM user_progression
    WHERE user_id = p_user_id;
    
    -- Calcul score global pondÃ©rÃ©
    v_global_score := (
        v_puzzle_score * 0.25 +
        v_tutorial_score * 0.20 +
        v_feature_score * 0.25 +
        v_sphere_score * 0.15 +
        v_engagement_score * 0.15
    )::INTEGER;
    
    -- Mettre Ã  jour
    UPDATE user_progression SET
        puzzle_score = v_puzzle_score,
        tutorial_score = v_tutorial_score,
        feature_score = v_feature_score,
        sphere_score = v_sphere_score,
        engagement_score = v_engagement_score,
        global_score = v_global_score,
        updated_at = NOW()
    WHERE user_id = p_user_id;
    
END;
$$ LANGUAGE plpgsql;

-- VÃ©rification niveau
CREATE OR REPLACE FUNCTION check_level_progression(p_user_id UUID)
RETURNS void AS $$
DECLARE
    v_current_level VARCHAR(20);
    v_new_level VARCHAR(20);
    v_metrics RECORD;
BEGIN
    -- RÃ©cupÃ©rer mÃ©triques
    SELECT * INTO v_metrics FROM user_progression WHERE user_id = p_user_id;
    v_current_level := v_metrics.level;
    
    -- DÃ©terminer nouveau niveau
    IF v_metrics.total_sessions >= 50 
       AND v_metrics.total_tutorials_completed >= 30 
       AND v_metrics.total_features_used >= 15 THEN
        v_new_level := 'expert';
    ELSIF v_metrics.total_sessions >= 20 
          AND v_metrics.total_tutorials_completed >= 10 
          AND v_metrics.total_pieces_collected >= 20 THEN
        v_new_level := 'active';
    ELSIF v_metrics.total_sessions >= 5 
          OR v_metrics.total_tutorials_completed >= 3 THEN
        v_new_level := 'explorer';
    ELSE
        v_new_level := 'newcomer';
    END IF;
    
    -- Mettre Ã  jour si changement
    IF v_new_level != v_current_level THEN
        UPDATE user_progression SET
            level = v_new_level,
            level_achieved_at = NOW(),
            updated_at = NOW()
        WHERE user_id = p_user_id;
        
        -- Notifier
        PERFORM pg_notify('level_change', json_build_object(
            'user_id', p_user_id,
            'old_level', v_current_level,
            'new_level', v_new_level
        )::text);
    END IF;
END;
$$ LANGUAGE plpgsql;

-- Snapshot quotidien
CREATE OR REPLACE FUNCTION create_daily_snapshot()
RETURNS void AS $$
BEGIN
    INSERT INTO progression_history (user_id, snapshot_date, level, global_score, scores, daily_metrics)
    SELECT 
        user_id,
        CURRENT_DATE,
        level,
        global_score,
        jsonb_build_object(
            'puzzle', puzzle_score,
            'tutorial', tutorial_score,
            'feature', feature_score,
            'sphere', sphere_score,
            'engagement', engagement_score
        ),
        jsonb_build_object(
            'pieces', total_pieces_collected,
            'tutorials', total_tutorials_completed,
            'features', total_features_used,
            'sessions', total_sessions,
            'time', total_time_minutes
        )
    FROM user_progression
    ON CONFLICT (user_id, snapshot_date) DO UPDATE SET
        level = EXCLUDED.level,
        global_score = EXCLUDED.global_score,
        scores = EXCLUDED.scores,
        daily_metrics = EXCLUDED.daily_metrics;
END;
$$ LANGUAGE plpgsql;
```

---

# 7. API PROGRESSION

```typescript
// Routes API Progression

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GET /api/progression/:userId
// Retourne l'Ã©tat de progression complet
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
interface ProgressionResponse {
  user: {
    id: string;
    level: 'newcomer' | 'explorer' | 'active' | 'expert';
    globalScore: number;
    scores: {
      puzzle: number;
      tutorial: number;
      feature: number;
      sphere: number;
      engagement: number;
    };
    streak: {
      current: number;
      longest: number;
    };
  };
  spheres: SphereProgression[];
  milestones: {
    achieved: Milestone[];
    inProgress: Milestone[];
    locked: Milestone[];
  };
  nextLevel: {
    name: string;
    progress: number;
    requirements: {
      name: string;
      current: number;
      target: number;
      met: boolean;
    }[];
  } | null;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GET /api/progression/:userId/history
// Retourne l'historique de progression
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
interface ProgressionHistoryResponse {
  history: {
    date: string;
    level: string;
    globalScore: number;
    scores: Record<string, number>;
  }[];
  trends: {
    scoreChange30d: number;
    velocityPiecesPerWeek: number;
    velocityTutorialsPerWeek: number;
  };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GET /api/progression/:userId/recommendations
// Retourne les recommandations personnalisÃ©es
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
interface RecommendationsResponse {
  nextTutorials: {
    id: string;
    title: string;
    reason: string;
    priority: 'high' | 'medium' | 'low';
  }[];
  nextPieces: {
    id: string;
    name: string;
    howToCollect: string;
    impact: string;
  }[];
  suggestedSpheres: {
    id: string;
    name: string;
    reason: string;
  }[];
  milestoneOpportunities: {
    id: string;
    name: string;
    progress: number;
    remaining: string;
  }[];
}
```

---

# 8. COMPOSANTS UI

## 8.1 Progression Widget

```typescript
// components/progression/ProgressionWidget.tsx

interface ProgressionWidgetProps {
  userId: string;
  variant: 'compact' | 'detailed' | 'full';
}

const ProgressionWidget: React.FC<ProgressionWidgetProps> = ({ userId, variant }) => {
  // Compact: Juste le niveau et score
  // Detailed: + barres de progression
  // Full: + liste sphÃ¨res + milestones proches
  
  return (
    <div className="progression-widget">
      {/* Niveau actuel */}
      <LevelBadge level={progression.level} />
      
      {/* Score global */}
      <ScoreCircle score={progression.globalScore} />
      
      {variant !== 'compact' && (
        <>
          {/* Barres sous-scores */}
          <ScoreBreakdown scores={progression.scores} />
          
          {/* Progression vers niveau suivant */}
          <NextLevelProgress next={progression.nextLevel} />
        </>
      )}
      
      {variant === 'full' && (
        <>
          {/* SphÃ¨res */}
          <SpheresOverview spheres={progression.spheres} />
          
          {/* Milestones proches */}
          <UpcomingMilestones milestones={progression.milestones.inProgress} />
        </>
      )}
    </div>
  );
};
```

## 8.2 Milestone Card

```typescript
// components/progression/MilestoneCard.tsx

interface MilestoneCardProps {
  milestone: Milestone;
  showProgress?: boolean;
}

const MilestoneCard: React.FC<MilestoneCardProps> = ({ milestone, showProgress }) => {
  return (
    <div className={`milestone-card ${milestone.status}`}>
      <span className="milestone-icon">{milestone.icon}</span>
      
      <div className="milestone-content">
        <h4>{milestone.name}</h4>
        <p>{milestone.description}</p>
        
        {showProgress && milestone.status === 'in_progress' && (
          <ProgressBar progress={milestone.progress} />
        )}
        
        {milestone.status === 'achieved' && (
          <span className="achieved-date">
            âœ“ {formatDate(milestone.achievedAt)}
          </span>
        )}
      </div>
    </div>
  );
};
```

---

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘                    SYSTÃˆME DE PROGRESSION COMPLET                            â•‘
â•‘                                                                              â•‘
â•‘     4 Niveaux | 30+ Milestones | Tracking Temps RÃ©el                        â•‘
â•‘                                                                              â•‘
â•‘           "Chaque action compte â€” Chaque progrÃ¨s est visible"               â•‘
â•‘                                                                              â•‘
â•‘                          ON CONTINUE! ğŸ’ªğŸ”¥                                   â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
